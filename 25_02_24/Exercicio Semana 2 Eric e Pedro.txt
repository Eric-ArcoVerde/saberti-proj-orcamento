CREATE TABLE CATEGORIA_PRODUTO (
CATEGORIAPRODUTOID INTEGER NOT NULL,
DS_CATEGORIA_PRODUTO VARCHAR(50) NOT NULL,
PRIMARY KEY(CATEGORIAPRODUTOID));

CREATE TABLE CLIENTE(
CLIENTEID INTEGER NOT NULL,
TIPO_CLIENTE CHAR(1) NOT NULL,
CPF_CNPJ_CLIENTE VARCHAR(18) NOT NULL,
NOME_CLIENTE VARCHAR(100) NOT NULL,
PRIMARY KEY(CLIENTEID));

CREATE TABLE PRODUTO (
PRODUTOID INTEGER NOT NULL,
CATEGORIAPRODUTOID INTEGER NOT NULL,
DS_PRODUTO VARCHAR(50) NOT NULL,
OBS_PRODUTO VARCHAR(300) NULL,
VL_VENDA_PRODUTO NUMERIC(15,2) NOT NULL,
DT_CADASTRO_PRODUTO TIMESTAMP NOT NULL,
STATUS_PRODUTO VARCHAR(10) NOT NULL,
PRIMARY KEY(PRODUTOID),
FOREIGN KEY (CATEGORIAPRODUTOID) references CATEGORIA_PRODUTO (CATEGORIAPRODUTOID));

CREATE TABLE ORCAMENTO(
ORCAMENTOID INTEGER NOT NULL,
CLIENTEID INTEGER NOT NULL,
DT_ORCAMENTO TIMESTAMP NOT NULL,
DT_VALIDADE_ORCAMENTO TIMESTAMP NOT NULL,
VL_TOTAL_ORCAMENTO NUMERIC(15,2) NOT NULL,
PRIMARY KEY(ORCAMENTOID),
FOREIGN KEY(CLIENTEID) REFERENCES CLIENTE(CLIENTEID));

CREATE TABLE ORCAMENTO_ITEM(
ORCAMENTOITEMID INTEGER NOT NULL,
ORCAMENTOID INTEGER NOT NULL,
PRODUTOID INTEGER NOT NULL,
QT_PRODUTO NUMERIC(15,2) NOT NULL,
VL_UNITARIO NUMERIC(15,2) NOT NULL,
VL_TOTAL NUMERIC(15,2) NOT NULL,
PRIMARY KEY(ORCAMENTOITEMID),
FOREIGN KEY(ORCAMENTOID) references ORCAMENTO (ORCAMENTOID),
FOREIGN KEY(PRODUTOID) references PRODUTO(PRODUTOID));

alter table orcamento_item add produto_desc varchar (50);

CREATE TABLE USUARIOS(
ID SERIAL PRIMARY KEY,
USUARIO VARCHAR(30),
NOME_COMPLETO VARCHAR(60),
SENHA VARCHAR(50));

INSERT INTO CATEGORIA_PRODUTO (CATEGORIAPRODUTOID, DS_CATEGORIA_PRODUTO) VALUES (1,'BASIC');
INSERT INTO CATEGORIA_PRODUTO (CATEGORIAPRODUTOID, DS_CATEGORIA_PRODUTO) VALUES (2,'PLATINUM');
INSERT INTO CATEGORIA_PRODUTO (CATEGORIAPRODUTOID, DS_CATEGORIA_PRODUTO) VALUES (3,'PREMIUM');
INSERT INTO CATEGORIA_PRODUTO (CATEGORIAPRODUTOID, DS_CATEGORIA_PRODUTO) VALUES (4,'ELITE');

INSERT INTO CLIENTE (CLIENTEID, tipo_cliente, CPF_CNPJ_CLIENTE, NOME_CLIENTE) VALUES (1, 'F','943.051.830-56','JOSÃ‰ DA SILVA');
INSERT INTO CLIENTE (CLIENTEID, tipo_cliente, CPF_CNPJ_CLIENTE, NOME_CLIENTE) VALUES (2, 'F','802.202.930-07','PEDRO DE OLIVEIRA');
INSERT INTO CLIENTE (CLIENTEID, tipo_cliente, CPF_CNPJ_CLIENTE, NOME_CLIENTE) VALUES (3, 'F','637.502.500-14','MARIA EDUARDA MEIRELES');
INSERT INTO CLIENTE (CLIENTEID, tipo_cliente, CPF_CNPJ_CLIENTE, NOME_CLIENTE) VALUES (4, 'F','997.192.890-66','SANDRA GOMES');

INSERT INTO PRODUTO (PRODUTOID, CATEGORIAPRODUTOID , DS_PRODUTO, OBS_PRODUTO, VL_VENDA_PRODUTO, DT_CADASTRO_PRODUTO, STATUS_PRODUTO) VALUES (1, 1,'CHAPA METALICA','CHAPA GENERICA', 106.22,'18/02/2022','ATIVO');
INSERT INTO PRODUTO (PRODUTOID, CATEGORIAPRODUTOID , DS_PRODUTO, OBS_PRODUTO,VL_VENDA_PRODUTO, DT_CADASTRO_PRODUTO, STATUS_PRODUTO) VALUES (2, 1,'FOLHA METALICA','FOLHA GENERICA', 10.88,'18/02/2022','ATIVO');
INSERT INTO PRODUTO (PRODUTOID, CATEGORIAPRODUTOID , DS_PRODUTO, OBS_PRODUTO,VL_VENDA_PRODUTO, DT_CADASTRO_PRODUTO,STATUS_PRODUTO) VALUES (3, 3,'CHAPA DOURADA','CHAPA ESPECIFICA', 158.88,'18/02/2022','ATIVO');
INSERT INTO PRODUTO (PRODUTOID, CATEGORIAPRODUTOID , DS_PRODUTO, OBS_PRODUTO,VL_VENDA_PRODUTO, DT_CADASTRO_PRODUTO,STATUS_PRODUTO) VALUES (4, 4,'FOLHA DIAMANTE','FOLHA UNICA', 665.33,'18/02/2022','ATIVO');

INSERT INTO ORCAMENTO (ORCAMENTOID, CLIENTEID, DT_ORCAMENTO, DT_VALIDADE_ORCAMENTO,
VL_TOTAL_ORCAMENTO) VALUES (1, 1,'18/02/2026','2026-02-19', 10700.00);
INSERT INTO ORCAMENTO (ORCAMENTOID, CLIENTEID, DT_ORCAMENTO, DT_VALIDADE_ORCAMENTO,
VL_TOTAL_ORCAMENTO) VALUES (2, 3,'17/02/2022','19/02/2022', 2700.00);
INSERT INTO ORCAMENTO (ORCAMENTOID, CLIENTEID, DT_ORCAMENTO, DT_VALIDADE_ORCAMENTO,
VL_TOTAL_ORCAMENTO) VALUES (3, 4,'18/02/2022','19/02/2022', 1200.00);
INSERT INTO ORCAMENTO (ORCAMENTOID, CLIENTEID, DT_ORCAMENTO, DT_VALIDADE_ORCAMENTO,
VL_TOTAL_ORCAMENTO) VALUES (4, 2,'17/02/2022','19/02/2022', 8000.00);

INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (1, 1, 1, 10, 100.00, 1000.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (2, 1, 2, 20, 10.00, 200.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (3, 1, 4, 30, 500.00, 1500.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (4, 1, 3, 40, 200.00, 8000.00);

INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (5, 2, 1, 10, 100.00, 1000.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (6, 2, 2, 20, 10.00, 200.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (7, 2, 4, 30, 500.00, 1500.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (8, 3, 1, 10, 100.00, 1000.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (9, 3, 2, 20, 10.00, 200.00);
INSERT INTO ORCAMENTO_ITEM (ORCAMENTOITEMID, ORCAMENTOID, PRODUTOID, QT_PRODUTO, VL_UNITARIO, VL_TOTAL) VALUES (10, 4, 3, 40, 200.00, 8000.00);

--SELECTS

select status_produto from produto
where status_produto = 'ATIVO';

select cp.ds_categoria_produto,
		p.ds_produto
from categoria_produto cp 
inner join produto p 
on cp.categoriaprodutoid = p.produtoid


select vl_venda_produto from produto 
where vl_venda_produto > 50.00;

select cl.nome_cliente,
       o.vl_total_orcamento,
	   o.dt_orcamento ,
	   o.dt_validade_orcamento
from orcamento o 
inner join cliente cl 
on o.clienteid = cl.clienteid; 

select oi.vl_unitario,
       oi.qt_produto,
       oi.vl_total,
       p.ds_produto,
       cp.ds_categoria_produto
from orcamento_item oi
inner join produto p
    on oi.produtoid = p.produtoid
inner join categoria_produto cp
    on cp.categoriaprodutoid = p.categoriaprodutoid;

select orcamentoid from orcamento
where dt_orcamento between '01/02/2022' and '19/02/2022';

select orcamentoid from orcamento 
where dt_validade_orcamento < CURRENT_DATE; 

select max (oi.vl_unitario), 
	   p.ds_produto
	   from orcamento_item oi
	   inner join produto p
	   on oi.produtoid = p.produtoid
group by (oi.vl_unitario), 
	   p.ds_produto;	   

select max(oi.vl_unitario * oi.qt_produto) as total
from orcamento_item oi;
	   
select sum(vl_total_orcamento) 
		from orcamento;

select sum(oi.qt_produto), 
	   o.orcamentoid
	   from orcamento_item oi
	   inner join orcamento o
	   on oi.orcamentoid = o.orcamentoid
 group by o.orcamentoid; 
	   	
	   	